def move_ball(board, previous_positions=None, get_board_at=lambda board, line, column: board[line][column], set_board_at=lambda board, value, line, column: board[line].__setitem__(column, value)): return move_ball([list(line) for line in board]) if isinstance(board[0], str) else move_ball(board, [(line, column) for line in range(len(board)) for column in range(len(board[line])) if get_board_at(board, line, column) in "NSEW"][:1]) if previous_positions is None else (lambda next_pos, next_vel: (get_board_at(board, *next_pos) == 'X' and (previous_positions + [next_pos])) or (set_board_at(board, next_vel, *next_pos) or set_board_at(board, ' ', *previous_positions[-1]) or move_ball(board, previous_positions + [next_pos])))({ 'N': lambda pos: (pos[0] - 1, pos[1]), 'S': lambda pos: (pos[0] + 1, pos[1]), 'E': lambda pos: (pos[0], pos[1] + 1), 'W': lambda pos: (pos[0], pos[1] - 1) }[get_board_at(board, *previous_positions[-1])](previous_positions[-1]), (lambda next_pos: { 'N': lambda board, next_pos: 'E' if get_board_at(board, *next_pos) == '/' else 'W' if get_board_at(board, *next_pos) == '\\' else 'N', 'S': lambda board, next_pos: 'W' if get_board_at(board, *next_pos) == '/' else 'E' if get_board_at(board, *next_pos) == '\\' else 'S', 'E': lambda board, next_pos: 'N' if get_board_at(board, *next_pos) == '/' else 'S' if get_board_at(board, *next_pos) == '\\' else 'E', 'W': lambda board, next_pos: 'S' if get_board_at(board, *next_pos) == '/' else 'N' if get_board_at(board, *next_pos) == '\\' else 'W' }[get_board_at(board, *previous_positions[-1])](board, next_pos))({ 'N': lambda pos: (pos[0] - 1, pos[1]), 'S': lambda pos: (pos[0] + 1, pos[1]), 'E': lambda pos: (pos[0], pos[1] + 1), 'W': lambda pos: (pos[0], pos[1] - 1) }[get_board_at(board, *previous_positions[-1])](previous_positions[-1]))) # "os one-liners do Miguel" :(
